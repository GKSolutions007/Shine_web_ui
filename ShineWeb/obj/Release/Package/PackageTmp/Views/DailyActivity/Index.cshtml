@model ShineWeb.Models.SingleMasterModel
@{
    ViewBag.Title = ViewData["FormName"];
}
<link href="~/Content/chosen.min.css" rel="stylesheet" />
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/navbar.css" rel="stylesheet" />
<link href="~/Content/buttonTop.css" rel="stylesheet" />
<link href="~/Content/dataTables.dataTables.2.2.2.css" rel="stylesheet" />
<link rel="stylesheet" href="~/Content/jquery-ui.css">

<script src="~/Scripts/bootstrap.min.js"></script>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script src="~/Scripts/jquery-3.7.1.js"></script>

<script src="~/Scripts/js/refreshtoken.js"></script>
<script src="~/Scripts/chosen.jquery.min.js"></script>
<script src="~/Scripts/jquerychoose.min.js"></script>
<script src="~/Scripts/jquery-ui.js"></script>
<script src="~/Scripts/dataTables.2.2.2.js"></script>
<header>
    <link rel="stylesheet" href="~/Content/index.css">
</header>

<style>
    th, td {
        white-space: nowrap;
    }
    .toolbar, .dt-search {
        float: right;
    }
    .gdInput {
        width: 100%;
        height: 25px;
        border-width: 0 0 0.1px 0;
        border-color: #e0d6d6;
    }

    .trtext-line {
        border: none;
        border-bottom: 1px #000000;
    }

    div.dataTables_wrapper {
        width: 100%;
        margin: 0 auto;
    }

    td {
        font-size: 11px;
    }

    input[type=number] {
        text-align: right;
    }

        input[type=number]::placeholder {
            text-align: left;
        }
    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    /* Firefox */
    input[type=number] {
        -moz-appearance: textfield;
    }
    /* The Modal (background) */
    .modalBatch {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 10; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal Content/Box */
    @@media only screen and (min-width: 600px) {
        .modalBatch-content {
            background-color: #ffffff;
            margin: 3% auto; /* 15% from the top and centered */
            padding: 10px;
            border: 1px solid #888;
            width: 75%; /* Could be more or less, depending on screen size */
            height: 70%;
            top: 5%;
            overflow: auto;
        }
    }

    @@media only screen and (max-width: 600px) {
        .modalBatch-content {
            background-color: #ffffff;
            margin: 10% auto; /* 15% from the top and centered */
            padding: 25px;
            border: 1px solid #888;
            width: 95%; /* Could be more or less, depending on screen size */
            height: 80%;
            top: 20%;
            overflow: auto;
        }
    }
    /* The Close Button */
    .closefg {
        color: #aaa;
        float: right;
        font-size: 10px;
        font-weight: bold;
    }

        .closefg:hover,
        .closefg:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

    .modalProdInfo {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 10; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal Content/Box */
    @@media only screen and (min-width: 600px) {
        .modalProdInfo-content {
            background-color: #ffffff;
            margin: 3% auto; /* 15% from the top and centered */
            padding: 10px;
            border: 1px solid #888;
            width: 75%; /* Could be more or less, depending on screen size */
            height: 70%;
            top: 5%;
            overflow: auto;
        }
    }

    @@media only screen and (max-width: 600px) {
        .modalProdInfo-content {
            background-color: #ffffff;
            margin: 10% auto; /* 15% from the top and centered */
            padding: 25px;
            border: 1px solid #888;
            width: 95%; /* Could be more or less, depending on screen size */
            height: 80%;
            top: 20%;
            overflow: auto;
        }
    }
    /* The Close Button */
    .closePinfo {
        color: #aaa;
        float: right;
        font-size: 10px;
        font-weight: bold;
    }

        .closePinfo:hover,
        .closePinfo:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

    /* Style the tab */
    .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
    }

        /* Style the buttons inside the tab */
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.5s;
            font-size: 17px;
        }

            /* Change background color of buttons on hover */
            .tab button:hover {
                background-color: #ddd;
            }

            /* Create an active/current tablink class */
            .tab button.active {
                background-color: #ccc;
            }

    /* Style the tab content */
    .tabcontent {
        display: none;
        /*padding: 6px 12px;*/
        border: none;
        border-top: none;
    }

    .form-label {
        position: relative;
        display: block;
        clear: both;
        max-width: 500px;
        margin: 0 auto;
    }

    .labelup {
        -webkit-transform: translateY(50%);
        -moz-transform: translateY(-50%);
        -ms-transform: translateY(-50%);
        -o-transform: translateY(-50%);
        transform: translateY(50%);
        -webkit-transition: all 0.2s ease-in-out;
        -moz-transition: all 0.2s ease-in-out;
        transition: all 0.2s ease-in-out;
        position: absolute;
        top: -40%;
        left: 1em;
        background: #fffefe;
        color: #2b2828;
        font-size: 1em;
        cursor: text;
        pointer-events: none;
        font-family: sans-serif;
    }

    .labelupfortextarea {
        -webkit-transform: translateY(50%);
        -moz-transform: translateY(-50%);
        -ms-transform: translateY(-50%);
        -o-transform: translateY(-50%);
        transform: translateY(50%);
        -webkit-transition: all 0.2s ease-in-out;
        -moz-transition: all 0.2s ease-in-out;
        transition: all 0.2s ease-in-out;
        position: absolute;
        top: -18%;
        left: 1em;
        background: #fffefe;
        color: #2b2828;
        font-size: 1em;
        cursor: text;
        pointer-events: none;
        font-family: sans-serif;
    }

    .footerAction {
        position: fixed;
        right: 0;
        bottom: 0;
        width: 85%;
        color: white;
        background-color: azure;
    }
    /*input:focus + .labelup,
    input:not(:placeholder-shown) + .labelup, textarea:focus + .labelup, textarea:not(:placeholder-shown) + .labelup {
        top: -35%;
        font-size: .9em;
        padding: 0 .3em;
        background: #F9F9F9;
        color: #000000;
    }*/
    .clsProd {
        position: fixed;
        right: 1%;
        bottom: 8%;
        width: 30%;
        height: 45%;
        color: black;
        background-color: #c2f6b5;
        z-index: 1000;
    }

    .each {
        border-bottom: 1px solid #555;
        padding: 3px 0;
    }

    .acItem .name {
        font-size: 14px;
        font-family: Arial, Helvetica, sans-serif;
    }

    .acItem .desc {
        font-size: 10px;
        font-family: Arial, Helvetica, sans-serif;
        color: #555;
    }

    .ui-autocomplete {
        max-height: 245px;
        overflow-y: auto;
        overflow-x: hidden;
    }
</style>
<body>
    <div class="row" style="margin-bottom:50px;">
        @Html.HiddenFor(model => model.FormName, new { @autocomplete = "off", @class = "form-control", @id = "txtFormName" })
        <h4 id="MainHeading">@ViewData["FormName"]</h4>
        <div class="toastBox"></div>
        <hr class="style14" />
        <div class="col-md-12" style="padding:5px;" align="center">
            <table cellpadding="0" id="tblParam1">
                <tbody>
                    <tr>
                        @Html.HiddenFor(model => model.TransType, new { @autocomplete = "off", @class = "form-control", @id = "txtTransType" })
                        @Html.HiddenFor(model => model.TransID, new { @autocomplete = "off", @class = "form-control", @id = "txtTransID" })
                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label(" Beat :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <div class="input-group">
                                <span class="input-group-addon"><span class="glyphicon glyphicon-map-marker"></span></span>
                                <select class="form-control FormclrcmbField" id="cmbBeatName">

                                    <option value="0">Select</option>
                                </select>
                            </div>
                            <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnBeatName" class="clrdivs"></div>
                        </td>
                    </tr>
                    <tr>

                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label(" SalesMan :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <div class="input-group">
                                <span class="input-group-addon"><span class="glyphicon glyphicon-user"></span></span>
                                <select class="form-control FormclrcmbField" id="cmbSalesManName">
                                    <option value="0">Select</option>
                                </select>
                            </div>
                            <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnSalesManName" class="clrdivs"></div>
                        </td>
                    </tr>
                    <tr>
                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("* Customer :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <input id="txtCustomerID" hidden/>
                            <div class="input-group">
                                <span class="input-group-addon" id="Custinfo"><span class="glyphicon glyphicon-info-sign"></span></span>
                                <input type="text" class="form-control FormclrField" id="txtCustomerName" />
                            </div>
                            <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnCustName" class="clrdivs"></div>
                        </td>
                    </tr>
                    <tr>

                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("* Branch :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <div class="input-group">
                                <span class="input-group-addon"><span class="glyphicon glyphicon-home"></span></span>
                                <select class="form-control FormclrcmbField" id="cmbBranchName">
                                    <option value="0">Select</option>
                                </select>
                            </div>
                            <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnBranchName" class="clrdivs"></div>
                        </td>
                    </tr>
                    @*<tr id="trPinc" hidden>
            <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("* Pincode :", new { @class = "clrWhite" })&#x2003;</td>
            <td colspan="2">
                <div class="input-group">
                    <span class="input-group-addon"><span class="fa fa-map-marker"></span></span>
                    <input type="number" class="form-control" id="txtPincode" />
                </div>
                <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnPincode"></div>
            </td>
        </tr>
        <tr style="padding-top:10px">
            <td></td>
            <td colspan="1">
                <div class="input-group">
                    <button class="form-control btn btn-warning AllowSHow" id="btnGetSurrCustomers" style="align-content:center"><span class="glyphicon glyphicon-map-marker"></span>&nbsp;Surrounding Customers</button>
                </div>
            </td>
            <td id="tdlocpin">
                <img id="imgLocGP" src="~/Images/locpin/greenlocipin.jpg" style="height:20px;width:20px" />
                <img id="imgLocRP" src="~/Images/locpin/redlocipin.jpg" style="height:20px;width:20px" />
            </td>
        </tr>*@
                </tbody>
            </table>
        </div>
        
        <div class="col-md-12" align="center">
            <div class="input-group" style="padding-left:5px;padding-bottom:5px; ">

                <label class="radio-inline" style="font-size:14px;color:brown "><input type="radio" name="rdoSelect" id="rdoOT" checked="checked" /><b><b>Order Taken</b></b></label>
                <label class="radio-inline" style="font-size:14px;color:brown"><input type="radio" name="rdoSelect" id="rdoFeedback" /><b><b>Feedback</b></b></label>
                <label class="radio-inline" style="font-size:14px;color:brown"><input type="radio" name="rdoSelect" id="rdoNOT" /><b><b>No Order Today</b></b></label>

            </div>

            <table cellpadding="0" id="tblot1">
                <tbody>
                    <tr>
                        <td></td>
                        <td>
                            <div class="input-group" style="padding-left:5px;padding-bottom:5px; ">
                                <font color="#skyblue">
                                    <label class="radio-inline" style="font-size:15px"><input type="radio" name="rdoFilter" id="rdo1" checked="checked" /><b><b>Manuf</b></b></label>
                                    <label class="radio-inline" style="font-size:15px"><input type="radio" name="rdoFilter" id="rdo2" /><b><b>Category</b></b></label>
                                    <label class="radio-inline" style="font-size:15px"><input type="radio" name="rdoFilter" id="rdo3" /><b><b>Product</b></b></label>

                                </font>
                            </div>
                        </td>
                    </tr>

                    @*<table cellpadding="0" id="tblParam2">
                    <tbody>*@
                <tr id="MainFilterData">

                    <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("Filter Datas :", new { @class = "clrWhite" })&#x2003;</td>
                    <td colspan="2">
                        <div class="input-group">
                            <span class="input-group-addon" id="Filter"><span class="fa fa-cube"></span></span>
                            <input type="text" class="form-control" id="txtProductName" placeholder="Product Name"/>
                            @*<span class="input-group-addon" id="Filter"><span class="glyphicon glyphicon-filter"></span></span>*@
                        </div>
                        <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnProductName" class="clrdivs"></div>
                    </td>
                    
                </tr>
                    <tr id="ManufCC">
                        <td class="paddingtd" align="right" style="color: deepskyblue;">@Html.Label("* Select :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <div class="input-group">
                                <select data-placeholder="Select Manufacturer..." multiple class="chosen-Manuf form-control" name="Manuf" style="width:200px">                                    
                                </select>
                                <span class="input-group-addon" id="ViewManuf"><span class="fa fa-eye"></span></span>
                            </div>
                            <button type="button" class="mfr-chosen-toggle select"><i class="glyphicon glyphicon-check"></i></button>
                            <button type="button" class="mfr-chosen-toggle deselect"><i class="glyphicon glyphicon-remove"></i></button>
                        </td>
                    </tr>
                    <tr id="ProdGrpCC">
                        <td class="paddingtd" align="right" style="color: deepskyblue;">@Html.Label("* Select :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <div class="input-group">
                                <select data-placeholder="Select Product Group..." multiple class="chosen-Category form-control" style="width:200px">
                                    @{
                                        <option value="0"></option>
                                        @*foreach (var item in Model.ProdGroupName)
                                        {
                                            <option value="@item.Value">@item.Text</option>
                                        }*@
                                    }
                                </select>
                                <span class="input-group-addon" id="ViewProdGrp"><span class="fa fa-eye"></span></span>
                            </div>

                            <button type="button" class="pgrp-chosen-toggle select" title="Select   All"><i class="glyphicon glyphicon-check"></i></button>
                            <button type="button" class="pgrp-chosen-toggle deselect" title="De-select All"><i class="glyphicon glyphicon-remove"></i></button>
                        </td>
                    </tr>
                    <tr id="ProdCC">
                        <td class="paddingtd" align="right" style="color: deepskyblue;">@Html.Label("* Select :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <div class="input-group">
                                <select data-placeholder="Select Product..." multiple class="chosen-Prod form-control" style="width:200px">                                    
                                </select>

                                <span class="input-group-addon" id="ViewProd"><span class="fa fa-eye"></span></span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                        </td>
                        <td>
                            <div style="color: red; padding-top: 5px; padding-left: 5px;" id="divErrorOnTransName"></div>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td colspan="10">
                            @*<div class="input-group">
                                <button class="form-control btn btn-info" id="btnLoadSelData" style="align-content:center"> Load Selected Data</button>
                            </div>
                            <br />*@
                            <table>
                                <tr>
                                    <td>
                                        <div class="input-group">
                                            <button class="form-control btn btn-info" id="btnLoadSelData" style="align-content:center"> Load Selected Data</button>
                                        </div>
                                    </td>
                                    @*<td colspan="2">
                                        <button type="button" class="mfr-chosen-toggle select"><i class="glyphicon glyphicon-check"></i></button>
                                        <button type="button" class="mfr-chosen-toggle deselect"><i class="glyphicon glyphicon-remove"></i></button>
                                    </td>*@
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("Addnl Disc% :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <div class="input-group">
                                <span class="input-group-addon"><span class="fa fa-gift"></span></span>
                                <input type="number" class="form-control" id="txtAddnlDisc" />
                            </div>
                            <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnAdtnlDisc" class="clrdivs"></div>
                        </td>
                    </tr>
                    <tr>
                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("Trade Disc% :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2">
                            <div class="input-group">
                                <span class="input-group-addon"><span class="fa fa-gift"></span></span>
                                <input type="number" class="form-control" id="txtTradeDisc" />
                            </div>
                            <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnTradeDisc" class="clrdivs"></div>
                        </td>
                    </tr>
                    @*<tr>
                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("OS / Count :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2" style="font-weight:bold;font-size:inherit;">@Html.Label("0", new { @class = "clrWhite", @id = "lblCustOS" })</td>
                    </tr>
                    <tr>
                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("Last OT Date :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2" style="font-weight:bold;font-size:inherit;color:orangered">@Html.Label("--", new { @class = "clrWhite", @id = "lbllastOTdate" })</td>
                    </tr>*@
                    @*<tr>
                        <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("Previous Invoices :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2" style="font-weight:bold;font-size:inherit;color:orangered">
                            <a href="void:javascript(0)" id="hrefViewInv"><< View >></a>
                            <div style="color: red; padding-top: 5px; padding-left: 5px;" id="divErrorOnView"></div>
                        </td>
                    </tr>*@
                    <tr>
                        <td class="paddingtd" align="right" style="color: deepskyblue;" hidden="hidden">@Html.Label("Latitude :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2" hidden="hidden">
                            <div class="input-group">
                                <span class="input-group-addon"><span class="glyphicon glyphicon-map-marker"></span></span>
                                <input type="number" class="form-control FormclrField" id="txtLatitude" />
                            </div>
                            <div style="color: red; padding-top: 5px; padding-left: 5px;" id="divErrorOnCusLatitude"></div>
                        </td>
                    </tr>
                    <tr>
                        <td class="paddingtd" align="right" style="color: deepskyblue;" hidden="hidden">@Html.Label("Longtitude :", new { @class = "clrWhite" })&#x2003;</td>
                        <td colspan="2" hidden="hidden">
                            <div class="input-group">
                                <span class="input-group-addon"><span class="glyphicon glyphicon-map-marker"></span></span>
                                <input type="number" class="form-control FormclrField" id="txtLongtitude" />
                            </div>
                            <div style="color: red; padding-top: 5px; padding-left: 5px;" id="divErrorOnCusLongtitude"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="col-md-12" align="center">
                <table id="tblFeedBack" align="center">
                    <tbody>
                        <tr>

                            <td class="paddingtd" align="right" style="color:deepskyblue;">@Html.Label("Feed Back :", new { @class = "clrWhite", @id = "lblFeedBack" })&#x2003;</td>
                            <td colspan="2">
                                <div class="input-group">
                                    <span class="input-group-addon"><span class="fa fa-newspaper-o"></span></span>
                                    <textarea class="form-control FormclrField" id="txtFeedBack"></textarea>
                                </div>
                                <div style="color:red;padding-top:5px;padding-left:5px;" id="divErrorOnFeedBack" class="clrdivs"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div id="divLoadingMsg"></div>
            <hr class="style14" />
            <div class="col-md-12" align="center">
                <table align="center">
                    <tbody>
                        <tr>
                            <td>
                                <button id="btnClear" type="button" class="btn btn-danger"><span class="glyphicon glyphicon-refresh" style="color:white"></span>&#x2009;Clear</button>
                            </td>
                            <td>
                                <button id="btnAddTop" type="button" class="btn btn-warning"><span class="glyphicon glyphicon-shopping-cart" style="color:white"></span>&#x2009;Add</button>
                            </td>
                            <td>
                                <button id="btnViewTop" type="button" class="btn btn-info"><span class="glyphicon glyphicon-open" style="color:white"></span>&#x2009;View</button>
                            </td>
                            <td>
                                <button id="btnSave" type="button" class="btn btn-success"><span class="glyphicon glyphicon-save" style="color:white"></span>&#x2009;Save</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div id="dvTable">
                <hr class="style14" id="hrline2" />
                <span class="glyphicon glyphicon-shopping-cart" id="cartTop" style="color:deepskyblue"></span>&#x2009;&#x2009;
                <span style="text-align:center;font-weight:bold;color:deepskyblue" id="divAddedItemsCountTop"></span>
                <table align="center" id="tblProductInfo" class="table table-hover table-bordered" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:0%;">ProdID</th>
                            <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:0%;">OrgPrice</th>
                            <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:5%;">#</th>
                            <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:55%;">Prod Info</th>
                            <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:15%;">Qty</th>
                            <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:15%;">Price</th>
                            <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:15%;">Disc %</th>
                        </tr>
                    </thead>                    
                </table>
                <span class="glyphicon glyphicon-shopping-cart" id="cartBottom" style="color:deepskyblue"></span>&#x2009;&#x2009;
                <span style="text-align:center;font-weight:bold;color:deepskyblue" id="divAddedItemsCountBottom"></span>
            </div>
        </div>

        @*<hr class="style14" id="hrline3" />
        <div class="col-md-12" align="center" id="BottomButtons">
            <table align="center">
                <tbody>
                    <tr>
                        <td>
                            <button id="btnClearBottom" type="button" class="btn btn-danger"><span class="glyphicon glyphicon-refresh" style="color:white"></span>&#x2009;Clear</button>
                        </td>
                        <td>
                            <button id="btnAddBottom" type="button" class="btn btn-warning"><span class="glyphicon glyphicon-shopping-cart" style="color:white"></span>&#x2009;Add</button>
                        </td>
                        <td>
                            <button id="btnViewBottom" type="button" class="btn btn-info"><span class="glyphicon glyphicon-open" style="color:white"></span>&#x2009;View</button>
                        </td>
                        <td>
                            <button id="btnSubmitBottom" type="button" class="btn btn-success"><span class="glyphicon glyphicon-save" style="color:white"></span>&#x2009;Save</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>*@
        <!-- The Modal -->
        <div id="myModalCust" class="modalCust">

            <!-- Modal content -->
            <div class="modalCust-content">
                <span class="closeCust">&times;</span>
                <div id="dvCustLoc" style="padding-top:40px">
                    <label style="color:brown"> These Customers are Surrounding you.</label><br />
                    Current Location :<label id="lblCurrLocation"> </label>
                    <div style="color:red;padding-top:5px;padding-left:5px;text-align:center" id="divErrorOnPopupSurrCust"></div>
                    <table align="center" id="tblCustomers" class="table table-hover table-bordered" width="100%">
                        <thead>
                            <tr>
                                <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:90%">Customer Name</th>
                                <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:10%">Distance</th>
                            </tr>
                        </thead>
                    </table>


                </div>
                <div id="dvInvoices" style="padding-top:40px">
                    <label style="color:brown"> Previous Invoices : </label>
                    <table align="center" id="tblInvoices" class="table table-hover table-bordered" width="100%">
                        <thead>
                            <tr>
                                <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:0%">InvID</th>
                                <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:20%">Doc ID</th>
                                <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:20%">Doc Date</th>
                                <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:25%">Ref No</th>
                                <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:15%">All Disc ₹</th>
                                <th style="background-color: deepskyblue;color:white;text-align:center;font-size: 12px;width:20%">Invoice Value</th>
                            </tr>
                        </thead>
                    </table>
                </div>
                <hr />
                <div align="right">
                    @*<button id="btnExport2" type="button" class="btn btn-info" style="height:30px; width:100px" hidden><span class="glyphicon glyphicon-export" style="color: white"></span>&#x2009;Export</button>*@
                    <button id="btnClsModel" type="button" class="btn btn-danger" style="height:30px; width:80px"> Close </button>
                </div>
            </div>
        </div>
        <a href="javascript:" id="return-to-top"><i class="icon-chevron-up"></i></a>
    </div>
</body>
<script type="text/javascript">
     var UID = '@Session["LoginUserID"]';
 var Aurl = '@Session["APIurl"]';
 var DefBranch = '@Session["DefaultBranch"]';
 var DecVal = '@Session["DecimalValues"]';
    var modal = document.getElementById("myModalCust");
    var span = document.getElementsByClassName("closeCust")[0];
    span.onclick = function () {
        modal.style.display = "none";
    }
    $('#btnClsModel').click(function () {
        modal.style.display = "none";
    });
    modal.style.display = "none";
    $(".chosen-Manuf").chosen({
        no_results_text: "Oops, nothing found!"
    })
    $(".chosen-Category").chosen({
        no_results_text: "Oops, nothing found!"
    })
    $('#ProdGrpCC').hide();
    $('#ProdCC').hide();
    $('#MainFilterData').hide();


    var Table = $('#tblProductInfo').DataTable({
        "bFilter": true,
        "bSearchable": false,
        "bInfo": false,
        "bPaginate": false,
        "ordering": false,
        scrollX: true,
        scrollCollapse: true,
        //dom: 'l<"toolbar">frtip',
        //initComplete: function () {
        //    $("div.toolbar")
        //        .html('<button type="button"  id="plus_button"><b> Add </b></button>');
        //},
        "columnDefs": [{ "targets": [0,1,6], "visible": false, searchable: false, ordering: false }]
        //"selected":true,
    });
    var CustTable = $('#tblCustomers').DataTable({
        "bFilter": true,
        "bSearchable": true,
        "bInfo": false,
        "bPaginate": false,
        "ordering": false,
        //"selected":true,
    });
    var tableInvoices = $('#tblInvoices').DataTable({
        "bFilter": true,
        "bSearchable": true,
        "bInfo": false,
        "bPaginate": false,
        "ordering": false,
        scrollY: "340px",
        scrollX: true,
        scrollCollapse: true,
        "columnDefs": [{ "targets": [0], "visible": false }],
        "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {
            if (iDisplayIndex % 2 == 0) {
                $('td', nRow).css('background-color', 'peachpuff');
            }

            else {
                $('td', nRow).css('background-color', 'white');
            }
        }
    });
    if ($('.chosen-container').length > 0) {
        $('.chosen-container').on('touchstart', function (e) {
            e.stopPropagation(); e.preventDefault();
            // Trigger the mousedown event.
            $(this).trigger('mousedown');
        });
    }
    GetData(1, UID);
    var allProducts = [], arrParty = [];
    function GetData(nMode, strID = null, strSalesmanID = null)
    {
        $.ajax({
            url: Aurl + "dailyactivity/getdata",
            type: 'get',
            contentType: 'json',
            data: {
                Mode: nMode, ID: strID,SalesmanID: strSalesmanID
            },
            xhrFields: {
                withCredentials: true
            },
            success: function (data) {
                if (nMode == 1) {
                    //cmbBeatName,cmbSalesManName,txtCustomerName,chosen-Manuf,chosen-Category,txtProductName
                    $('#cmbBeatName,#cmbSalesManName,#cmbFilterSalesman').find("option").remove();
                    $('#cmbBeatName,#cmbSalesManName,#cmbFilterSalesman').append($('<option/>', {
                        value: 0,
                        text: "-- Select --",
                    }));
                    $('.chosen-Manuf').empty().trigger('chosen:updated');
                    $('.chosen-Category').empty().trigger('chosen:updated');
                    allProducts = [];
                    $.each(data, function (i, items) {
                        if (items.FType == 5) {
                            var Prod = {
                                "label": items.Code + " | " + items.Name,
                                "name": items.Name,
                                "code": items.Code,
                                "id": items.ID,
                            }
                            allProducts.push(Prod);
                        }
                        if (items.FType == 1) {
                            $('#cmbSalesManName').append($('<option/>', {
                                value: items.ID,
                                text: items.Name,
                            }));
                        }
                        if (items.FType == 2) {
                            $('#cmbBeatName').append($('<option/>', {
                                value: items.ID,
                                text: items.Name,
                            }));
                        }
                        if (items.FType == 3) {
                            $('.chosen-Manuf').append($('<option/>', {
                                value: items.ID,
                                text: items.Name,
                            }));
                        }
                        if (items.FType == 4) {
                            $('.chosen-Category').append($('<option/>', {
                                value: items.ID,
                                text: items.Name,
                            }));
                        }
                        if (items.FType == 6) {
                            $('#cmbBranchName').append($('<option/>', {
                                value: items.ID,
                                text: items.Name,
                            }));
                        }
                        if (items.FType == 7) {
                            //console.log("Beat : " + items.Code + " ,Salesman : " + items.Name);
                            $('#cmbSalesManName').val(items.Name);
                            $('#cmbBeatName').val(items.Code);
                            $('#cmbBranchName').val(items.ID);
                        }
                    });
                    $('.chosen-Manuf,.chosen-Category').trigger('chosen:updated');
                    SetAutlistforFields("txtProductName", allProducts);
                    setTimeout(() => {
                        GetData(2, $('#cmbBeatName').val(), $('#cmbSalesManName').val());
                    }, 500);
                }
                else if (nMode == 2) {
                    arrParty = [];
                    $.each(data, function (i, items) {
                        if (items.FType == 8) {
                            var Prod = {
                                "label": items.Code + " | " + items.Name,
                                "name": items.Name,
                                "code": items.Code,
                                "id": items.ID,
                            }
                            arrParty.push(Prod);
                        }
                    });
                    SetAutlistforFields("txtCustomerName", arrParty);
                }
                else if (nMode == 3) {
                    var isDisable = nTransMode == 3 || nTransMode == 5 ? "disabled" : "";
                    $.each(data, function (i, items) {
                        $("#txtID").val(items.ID),
                            $("#dtpDate").val(items.Date),
                            $("#lblDocID").text(items.DocID),
                            $("#cmbSalesman").val(items.SalesmanID),
                            $("#txtRefNo").val(items.RefNo),
                            $("#txtStatus").val(items.Status);
                    });
                    $('#btnViewInvoices').hide();
                    var custjsdata = JSON.parse(data[0].lstJsonAssignDetails);
                    $('#tblInvoiceData').DataTable({
                        scrollY: "250px",
                        scrollX: true,
                        scrollCollapse: true,
                        paging: false,
                        destroy: true,
                        data: custjsdata,
                        fixedColumns: false,
                        ordering: true,
                        searching: true,
                        sorting: true,
                        columns: [
                            { "data": "ID", "autoWidth": true, "visible": false, className: "dt-body-left" },
                            {
                                className: "dt-body-center",
                                "mRender": function (data, type, value, meta) {
                                    var rowIndex = meta.row;
                                    var checkboxId = 'chkCustomerCheck_' + rowIndex;//value.CustomerID
                                    var _action = '<input type="checkbox" checked id="' + checkboxId + '"  name="CustomerCheck" ' + isDisable + ' style="" InvoiceID="' + value.ID + '" />';
                                    return _action;
                                },
                            },
                            {
                                className: "dt-body-center",
                                "mRender": function (data, type, value, meta) {
                                    var rowIndex = (meta.row + 1);
                                    var _action = rowIndex;
                                    return _action;
                                },
                            },
                            { "data": "DocID", "autoWidth": true, className: "dt-body-left" },
                            { "data": "Date", "autoWidth": true, className: "dt-body-left" },
                            { "data": "RefNo", "autoWidth": true, className: "dt-body-left" },
                            { "data": "Beat", "autoWidth": true, className: "dt-body-left" },
                            { "data": "Salesman", "autoWidth": true, className: "dt-body-left" },
                            { "data": "Customer", "autoWidth": true, className: "dt-body-left" },
                            { "data": "NetAmt", "autoWidth": true, className: "dt-body-right" },
                            { "data": "Balance", "autoWidth": true, className: "dt-body-right" },
                            { "data": "Ageing", "autoWidth": true, className: "dt-body-right" }
                        ],
                    });
                    InvoiceTable = $('#tblInvoiceData').DataTable();
                    if (InvoiceTable.rows().count() == 0) {
                        showErrorSnackbar("No records found")
                    }
                }
                else if (nMode == 5) {
                    var isDisable = nTransMode == 3 || nTransMode == 5 ? "disabled" : "";
                    var custjsdata = data;// JSON.parse();
                    $('#tblInvoiceData').DataTable({
                        scrollY: "250px",
                        scrollX: true,
                        scrollCollapse: true,
                        paging: false,
                        destroy: true,
                        data: custjsdata,
                        fixedColumns: false,
                        ordering: true,
                        searching: true,
                        sorting: true,
                        columns: [
                            { "data": "ID", "autoWidth": true, "visible": false, className: "dt-body-left" },
                            {
                                className: "dt-body-center",
                                "mRender": function (data, type, value, meta) {
                                    var rowIndex = meta.row;
                                    var checkboxId = 'chkCustomerCheck_' + rowIndex;//value.CustomerID
                                    var _action = '<input type="checkbox" id="' + checkboxId + '"  name="CustomerCheck" ' + isDisable + ' style="" InvoiceID="' + value.ID + '" />';
                                    return _action;
                                },
                            },
                            {
                                className: "dt-body-center",
                                "mRender": function (data, type, value, meta) {
                                    var rowIndex = (meta.row + 1);
                                    var _action = rowIndex;
                                    return _action;
                                },
                            },
                            { "data": "DocID", "autoWidth": true, className: "dt-body-left" },
                            { "data": "Date", "autoWidth": true, className: "dt-body-left" },
                            { "data": "RefNo", "autoWidth": true, className: "dt-body-left" },
                            { "data": "Beat", "autoWidth": true, className: "dt-body-left" },
                            { "data": "Salesman", "autoWidth": true, className: "dt-body-left" },
                            { "data": "Customer", "autoWidth": true, className: "dt-body-left" },
                            { "data": "NetAmt", "autoWidth": true, className: "dt-body-right" },
                            { "data": "Balance", "autoWidth": true, className: "dt-body-right" },
                            { "data": "Ageing", "autoWidth": true, className: "dt-body-right" }
                        ],
                    });
                    InvoiceTable = $('#tblInvoiceData').DataTable();

                    if (InvoiceTable.rows().count() == 0) {
                        showErrorSnackbar("No records found")
                    }
                }
            }, error: function (data) {
                if (data.status == "401") {
                    var msg = data.responseJSON.Message;
                    ////showErrorSnackbar(msg + " Logout and Login again.");
                }
            }
        });
    }
    $('#cmbBeatName,#cmbSalesManName').change(function () {
        $(".clrdivs").html("");
        $("txtCustomerName").val();
         GetData(2, $('#cmbBeatName').val(), $('#cmbSalesManName').val());
    });
    function SetAutlistforFields(FieldID, arryvalue) {
        $("#" + FieldID).autocomplete({
            minLength: 0,
            source: arryvalue,
            select: function (event, ui) {
                $("#" + FieldID).val(ui.item.name);
                if (FieldID == "txtCustomerName") {
                    //customer info function
                    $("#txtCustomerID").val(ui.item.id);                    
                }
                return false;
            },
        }).autocomplete("instance")._renderItem = function (ul, item) {
            return $("<li class='each'>")
                .append("<div class='acItem'><span class='name'>" +
                    item.label + "</span></div>")
                .appendTo(ul);
        };
    }
    var rdoCheckedID = 0;
    var rdoActionID = 0;
    assignCheckedID();
    assignActionID();

    function assignCheckedID() {
        rdoCheckedID = (
            $('#rdo1').is(':checked') ? 1 :
                $('#rdo2').is(':checked') ? 2 : 3
        );
    }
    function assignActionID() {
        rdoActionID = (
            $('#rdoOT').is(':checked') ? 1 :
                $('#rdoFeedback').is(':checked') ? 2 : 3
        );
    }
    $('#rdo1,#rdo2,#rdo3').click(function () {
        FilterCheckedchange();
        //LoadMLPcmb("MANUF_NAME", rdoCheckedID)
    });
    function FilterCheckedchange() {
        assignCheckedID();
        //GetAutolistNames("MANUF_NAME", rdoCheckedID);
        if (rdoCheckedID == 1) {//Manuf
            $('#ManufCC').show();
            $('#ProdGrpCC').hide();
            $('#ProdCC').hide();
            $('#MainFilterData').hide();
            $('#btnLoadSelData').show();
        }
        else if (rdoCheckedID == 2) {//Prod Grp
            $('#ProdGrpCC').show();
            $('#ManufCC').hide();
            $('#ProdCC').hide();
            $('#MainFilterData').hide();
            $('#btnLoadSelData').show();
        }
        else {//Prod
            $('#ProdCC').hide();
            $('#ManufCC').hide();
            $('#ProdGrpCC').hide();
            $('#MainFilterData').show();
            $('#btnLoadSelData').show();
            $('#txtProductName').val('');
            $('#txtProductName').focus();
        }
        $('.chosen-Manuf').val('').trigger('chosen:updated');
        $('.chosen-Category').val('').trigger('chosen:updated');
    }
    $(window).scroll(function () {
        if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
            $('#return-to-top').fadeIn(200);    // Fade in the arrow
        } else {
            $('#return-to-top').fadeOut(200);   // Else fade out the arrow
        }
    });

    $('#return-to-top').click(function () {      // When arrow is clicked
        $('body,html').animate({
            scrollTop: 0                       // Scroll to top of body
        }, 500);
    });
    $('#txtBeatName').focus()
    $('#tblFeedBack').hide();
    function ShowHideFields(IsShow) {
        $('#tblFeedBack').hide();
        if (IsShow == false) {
            $('#dvTable').hide(); $('#tblot1').hide();
            $('#divAddedItemsCountBottom').hide(); $('#divAddedItemsCountTop').hide();
            $('#cartBottom').hide(); $('#cartTop').hide();
            $('#BottomButtons').hide();
            $('#btnAddTop').hide(); $('#btnViewTop').hide();
            $('#hrline2').hide(); $('#hrline3').hide();
            $("#btnSave,#btnSubmitBottom").prop("disabled", false);
            Table.search('').columns().search('').draw();
            $("div.dataTables_filter").hide();
        }
        else {
            $('#dvTable').show(); $('#tblot1').show();
            $('#divAddedItemsCountBottom').show(); $('#divAddedItemsCountTop').show();
            $('#cartBottom').show(); $('#cartTop').show();
            $('#BottomButtons').show();
            $('#btnAddTop').show(); $('#btnViewTop').show();
            $('#hrline2').show(); $('#hrline3').show();
            $("#btnSave,#btnSubmitBottom").prop("disabled", true);
            Table.search('').columns().search('').draw();
            $("div.dataTables_filter").show();
        }
    }
    
    $("#btnViewTop,#btnViewBottom").prop("disabled", true);
    $('#rdoOT').click(function () {
        ShowHideFields(true);
        assignActionID();
    });
    $('#rdoFeedback').click(function () {
        ShowHideFields(false);
        $('#tblFeedBack').show();
        assignActionID();
    });
    $('#rdoNOT').click(function () {
        ShowHideFields(false);
        assignActionID();
    });
    $('#Custinfo').click(function () {
        $('#divErrorOnCustName').html('');
        if ($('#txtCustomerName').val() != "") {
            GetCustomerInfo();
            //ShowMsgPopup(CusInfo);
        } else {
            $('#divErrorOnCustName').html('Select Customer');
        }
    });
    function GetCustomerInfo() {

        var CusInfo = "";
        //$.ajax({
        //    url: URLink,//'http://localhost:51918/api/DailyActivities',//URLink,//
        //    type: "GET",
        //    datatype: "JSON",
        //    data: { Flag: 7, Connection: StrCon, ALFieldName: "", BeatorManuf: $('#txtCustomerName').val(), Salesman: "", CheckedID: 0 },
        //    success: function (data) {
        //        if (data.length > 0) {
        //            $.each(data, function (i, items) {
        //                CusInfo += '<table style="width:100%;" class="table table-hover table-bordered"><tr><td>Billing Address</td><td>' + items.BillAdd + '</td></tr><tr><td>Shipping Address</td><td>' + items.ShipAdd + '</td></tr>'
        //                CusInfo += '<tr><td>Contact Person</td><td>' + items.ContPerson + '</td></tr><tr><td>Mob No</td><td>' + items.MobileNo + '</td></tr><tr><td>GSTIN</td><td>' + items.GSTIN + '</td></tr></table></body>'
        //            });
        //            ShowMsgPopup(CusInfo);
        //        } else {
        //            $('#divErrorOnCustName').html('Select Valid Customer');
        //        }
        //    }
        //});
    }    
    $('#btnLoadSelData').click(function () {    
    $("#divErrorOnTransName").html("");
        $("#divErrorOnCustName").html("");
        var var_FilterValues = rdoCheckedID == 3 ? $('#txtProductName').val() : rdoCheckedID == 1 ? $(".chosen-Manuf").val() : $(".chosen-Category").val();
        var var_Cust = 1;// $('#txtCustomerID').val();
        var var_Branch = $('#cmbBranchName').val();
        Table.search('').columns().search('').draw();
    //AddItemsinCart();
    //ShowMsgPopup(var_ManufName);
        var isf = false;
        if (var_Cust != "" && var_Branch > 0) {
            $('#tblProductInfo').DataTable({
                scrollY: "450px",
                scrollX: true,
                scrollCollapse: true,
                paging: false,
                destroy: true,
                ajax: {
                    url: Aurl + "dailyactivity/itemfilter",
                    type: "GET",
                    datatype: "JSON",
                    xhrFields: {
                        withCredentials: true
                    },
                    data: { Mode: 4, CustomerID: var_Cust, BranchID: var_Branch, FilterType: rdoCheckedID, FilterValue: var_FilterValues }
                },
                fixedColumns: false,
                searching: true,
                ordering: true,
                sorting: true,
                //"pagingType": "full_numbers",
                //dom: 'l<"toolbar">frtip',
                //initComplete: function () {
                //    $("div.toolbar")
                //        .html('<button type="button"  id="plus_button"><b> Add </b></button>');
                //},
                columns: [
                    { "data": "ID", "autoWidth": true, "visible": false, className: "dt-body-left" },
                    { "data": "Rate", "autoWidth": true, "visible": false, className: "dt-body-left" },
                    {
                        className: "dt-body-center",
                        "mRender": function (data, type, value, meta) {
                            var rowIndex = (meta.row + 1);
                            var _action = rowIndex;
                            return _action;
                        },
                    },                                 
                    {
                        className: "dt-body-left",
                        "mRender": function (data, type, value, meta) {
                            var _action = '<b >' + value.Name + '</b><br/>' + value.PriceDesc;
                            return _action;
                        },
                    },
                    {
                        className: "dt-body-right",
                        "mRender": function (data, type, value, meta) {
                            var rowIndex = meta.row;
                            var fids = 'chkProductsQty_' + rowIndex;
                            var _action = '<input type="number" class="dgvQty" name="Qty" id="' + fids + '" value="0" style="text-align:right;width:55px;"maxlength = "16"/>' ;
                            return _action;
                        },
                    },
                    {
                        className: "dt-body-right",
                        "mRender": function (data, type, value, meta) {
                            var rowIndex = meta.row;
                            var fids = 'chkProductsPrice_' + rowIndex;
                            var _action = '<input type="number" class="dgvPrice" name="Price" id="' + fids + '" value="' + value.Rate + '" style="text-align:right;width:55px;"maxlength = "16"/>' ;
                            return _action;
                        },
                    },
                    {
                        className: "dt-body-right", "visible": false,
                        "mRender": function (data, type, value, meta) {
                            var rowIndex = meta.row;
                            var fids = 'chkProductsDiscPern_' + rowIndex;
                            var _action = '<input type="number" class="dgvDiscPern" name="DiscountPern" id="' + fids + '" value="' + value.Discount + '" style="text-align:right;width:55px;"maxlength = "16"/>' ;
                            return _action;
                        },
                    }
                ],
            });
            //CalcProdDtl();                        
            Table = $('#tblProductInfo').DataTable();
        }
        else {           
            if (var_CustName == "") {
                $("#divErrorOnCustName").html("Select Customer");
            }
            if (var_Branch == 0) {
                $("#divErrorOnBranchName").html("Select Branch");
            }
        }
    });
    $(document).on("click", "#plus_button", function (e) {
        Table.search('').columns().search('').draw();
        CalcProdDtl();
    });
    $(document).on("click", ".dgvQty,.dgvPrice,.dgvDiscPern", function (e) {
        $(this).select();
    });
    $(document).on("change", ".dgvQty,.dgvPrice", function (e) {
        CalcProdDtl();
    });
    $('.mfr-chosen-toggle,.pgrp-chosen-toggle').each(function (index) {
        console.log(index);
        $(this).on('click', function () {
            var pn = $(this).parent();
            var fnd = $(this).parent().find('option');
            $(this).parent().find('option').prop('selected', $(this).hasClass('select')).parent().trigger('chosen:updated');
        });
    });
    var sum = 0, nCount = 0, mSum = 0;
    function CalcProdDtl() {
        var objItemDetails = [];
        var totamt = sum, amt = 0, isGridEmpty = 0;
        ClearErrorMsg();
        //loaditemcounttotamt("0", "0.00");
        var isGO = false;
        var prodid = '0', qty = '0', prodname = '0',PDisc = 0;
        amt = 0, isGridEmpty = 0, mrp = '0', Price = 0;
        $("#tblProductInfo tbody tr").each(function () {
            var rowdata = Table.row($(this)).data();
            var RowIndex = Table.row($(this)).index();
            var GridProdID = rowdata.ID;//[0];
            var GridorgRate = rowdata.Rate;//[1];
            var GridProdRateInfo = rowdata.PriceDesc;//[2];
            var GridProdName = rowdata.Name;
            $(this).find("input").each(function (index) {
                const fieldName = $(this).attr("name");
                const fieldID = $(this).attr("id");
                if (fieldName == "Qty") {
                    qty = $(this).val();
                }
                if (fieldName == "Price") {
                    Price = $(this).val();
                }
                if (fieldName == "DiscountPern") {
                    PDisc = $(this).val();
                }                
            });
            if (qty > 0) {
                amt = qty * Price;
                var singleList = {
                    'Name': GridProdName.toString(),
                    'PriceDesc': GridProdRateInfo.toString(),
                    'ID': GridProdID.toString(),
                    'Discount': PDisc.toString(),
                    'Qty': qty.toString(),
                    'Rate': GridorgRate.toString(),
                    'AppPrice': Price.toString()
                };
                objItemDetails.push(singleList);
                totamt = totamt + amt;
                qty = 0;
            }
        });        
        if (objItemDetails.length > 0) {
            $("#btnSave,#btnSubmitBottom").prop("disabled", false);
            $("#btnViewTop,#btnViewBottom").prop("disabled", false);
            loaditemcounttotamt(nCount + objItemDetails.length, totamt, totamt - mSum);
        }
    }

    var objItemDetails = [];
    var totamt = 0, amt = 0, isGridEmpty = 0;
    loaditemcounttotamt("0", "0.00", "0.00");
    $('#btnAddTop,#btnAddBottom').click(function () {
        AddItemsinCart();
    });
    function ClearErrorMsg() {
        $(".clrdivs").html("");
    }
    function loaditemcounttotamt(count, totamt, amt) {
        $('#divAddedItemsCountTop').html('' + count + ' items in cart - Tot Amt : ' + parseFloat(totamt).toFixed(2) + ',' +
            '<br\>' + 'M. Amt :' + parseFloat(amt).toFixed(2));
        $('#divAddedItemsCountBottom').html('' + count + ' items in cart -  Tot Amt : ' + parseFloat(totamt).toFixed(2) + ',' +
            '<br\>' + 'M. Amt :' + parseFloat(amt).toFixed(2));
    }
    function AddItemsinCart() {
        ClearErrorMsg();
        var isGO = false;
        var prodid = '0', qty = '0', prodname = '0', PDisc = 0;
        amt = 0, isGridEmpty = 0, mrp = '0', Price = 0;
        var ProdCount = Table.rows().count(); 
        if (ProdCount > 0) {
            $("#tblProductInfo tbody tr").each(function () {
                var rowdata = Table.row($(this)).data();
                var RowIndex = Table.row($(this)).index();
                var GridProdID = rowdata.ID;//[0];
                var GridorgRate = rowdata.Rate;//[1];
                var GridProdRateInfo = rowdata.PriceDesc;//[2];
                var GridProdName = rowdata.Name;
                $(this).find("input").each(function (index) {
                    const fieldName = $(this).attr("name");
                    const fieldID = $(this).attr("id");
                    if (fieldName == "Qty") {
                        qty = $(this).val();
                    }
                    if (fieldName == "Price") {
                        Price = $(this).val();
                    }
                    if (fieldName == "DiscountPern") {
                        PDisc = $(this).val();
                    }
                });
                if (qty > 0) {
                    amt = qty * Price;
                    var singleList = {
                        'Name': GridProdName.toString(),
                        'PriceDesc': GridProdRateInfo.toString(),
                        'ID': GridProdID.toString(),
                        'Discount': PDisc.toString(),
                        'Qty': qty.toString(),
                        'Rate': GridorgRate.toString(),
                        'AppPrice': Price.toString()
                    };
                    objItemDetails.push(singleList);
                    totamt = totamt + amt;
                    qty = 0;
                }
            });
            if (objItemDetails.length > 0) {
                //$("#btnSave,#btnSubmitBottom").prop("disabled", false);
                $("#btnViewTop,#btnViewBottom").prop("disabled", false);
                loaditemcounttotamt(objItemDetails.length, totamt, 0);
                Table.clear().draw();
                $('.chosen-Manuf').val('').trigger('chosen:updated');
                $('.chosen-Category').val('').trigger('chosen:updated');
                $('#txtProductName').val('');
                //$('#txtManufName').focus();
            }
            else {
                //ShowMsgPopup('Choose atleast one item in grid');
            }
            sum = totamt;
            nCount = objItemDetails.length;
            mSum = totamt;
        }
    }
    $('#btnViewTop,#btnViewBottom').click(function () {
        Table.search('').columns().search('').draw();
        AddItemsinCart();
        totamt = 0;
        ClearErrorMsg();
        if (objItemDetails.length > 0) {
            loaditemcounttotamt("0", "0.00", "0.00");
            //$("#txtManufName").prop("disabled", true);
            //$("#btnSave,#btnSubmitBottom").prop("disabled", true);
            $("#btnViewTop,#btnViewBottom").prop("disabled", true);
            Table.clear().draw();
            var IsreadOnly = "";// $('#txtPriceEditable').val() == "0" ? "Readonly=" + "Readonly" : "";            
            $('#tblProductInfo').DataTable({
                scrollY: "450px",
                scrollX: true,
                scrollCollapse: true,
                paging: false,
                destroy: true,                
                fixedColumns: false,
                data: objItemDetails,
                searching: true,
                ordering: true,
                sorting: false,
                //"pagingType": "full_numbers",
                dom: 'l<"toolbar">frtip',
                initComplete: function () {
                    $("div.toolbar").html('<button type="button"  id="plus_button"><b> Add </b></button>');
                },
                columns: [
                    { "data": "ID", "autoWidth": true, "visible": false, className: "dt-body-left" },
                    { "data": "Rate", "autoWidth": true, "visible": false, className: "dt-body-left" },
                    {
                        className: "dt-body-center",
                        "mRender": function (data, type, value, meta) {
                            var rowIndex = (meta.row + 1);
                            var _action = rowIndex;
                            return _action;
                        },
                    },
                    {
                        className: "dt-body-left",
                        "mRender": function (data, type, value, meta) {
                            var _action = '<b >' + value.Name + '</b><br/>' + value.PriceDesc;
                            return _action;
                        },
                    },
                    {
                        className: "dt-body-right",
                        "mRender": function (data, type, value, meta) {
                            var rowIndex = meta.row;
                            var fids = 'chkProductsQty_' + rowIndex;
                            var _action = '<input type="number" class="dgvQty" name="Qty" id="' + fids + '" value="' + value.Qty + '" style="text-align:right;width:55px;"maxlength = "16"/>';
                            return _action;
                        },
                    },
                    {
                        className: "dt-body-right",
                        "mRender": function (data, type, value, meta) {
                            var rowIndex = meta.row;
                            var fids = 'chkProductsPrice_' + rowIndex;
                            var _action = '<input type="number" class="dgvPrice" name="Price" id="' + fids + '" value="' + value.AppPrice + '" style="text-align:right;width:55px;"maxlength = "16"/>';
                            return _action;
                        },
                    },
                    {
                        className: "dt-body-right", "visible": false, 
                        "mRender": function (data, type, value, meta) {
                            var rowIndex = meta.row;
                            var fids = 'chkProductsDiscPern_' + rowIndex;
                            var _action = '<input type="number" class="dgvDiscPern" name="DiscountPern" id="' + fids + '" value="' + value.Discount + '" style="text-align:right;width:55px;"maxlength = "16"/>';
                            return _action;
                        },
                    }
                ],
            });
            Table = $('#tblProductInfo').DataTable();
            objItemDetails = [];
        }
        else {
            ShowMsgPopup('No items in cart');
        }
    });
    $("#btnClear").click(function () {
        //ClearForm();
        if (cfFocus != 3) { ClearConfirmDialogMsg("Do you want to clear?"); } else { ClearForm(); }
    });
    function SaveValidation() {
        var IsValid = true;
        $(".clrdivs").html("");
        if ($('#txtCustomerName').val() == '') {
            IsValid = false;
            $('#divErrorOnCustName').html('* Customer Name should not be empty');
            $('#txtCustomerName').focus();
        }
        else {
            const exists = arrParty.filter(c => c.name == $("#txtCustomerName").val().trim());
            if (exists.length == 0) {
                IsValid = false;
                $("#divErrorOnCustName").html("Select Party Name from list");
                showErrorSnackbar("Select Party Name from list");
            }
        }
        //txtAddnlDisc,txtTradeDisc,divErrorOnAdtnlDisc,divErrorOnTradeDisc
        if (rdoActionID == 1) {
            if ($('#txtAddnlDisc').val() != "" && $('#txtAddnlDisc').val() < 0 || $('#txtAddnlDisc').val() > 100) {
                IsValid = false;
                $('#divErrorOnAdtnlDisc').html('* Discount should be between 0 - 100 only');
                $('#txtAddnlDisc').focus();
            }
            if ($('#txtTradeDisc').val() != "" && $('#txtTradeDisc').val() < 0 || $('#txtTradeDisc').val() > 100) {
                IsValid = false;
                $('#divErrorOnTradeDisc').html('* Discount should be between 0 - 100 only');
                $('#txtTradeDisc').focus();
            }
            if (objItemDetails.length == 0) {
                IsValid = false;
                showErrorSnackbar("Add atleast one items");
            }
            if (IsValid) {
                AddItemsinCart();
            }
        }
        else {
            objItemDetails = [];
            $('#txtAddnlDisc,#txtTradeDisc').val(0);
        }        
        return IsValid;
    }   
    function ClearForm() {
        $(".FormclrField").val("");
        $(".FormclrcmbField").val(0);
        $(".clrdivs").html("");
        GetData(1, UID);
        Table.clear().draw();
        objItemDetails = [];
        loaditemcounttotamt("0", "0.00", "0.00");
        Table.search('').columns().search('').draw();
        $('.chosen-Manuf').val('').trigger('chosen:updated');
        $('.chosen-Category').val('').trigger('chosen:updated');
    }
    function SaveData() {
        //cmbBeatName, cmbSalesManName, txtCustomerName, chosen - Manuf, chosen - Category, txtProductName
        $("#btnSave").prop("disabled", true);
        lstTrans = {
            BeatID: $('#cmbBeatName').val(),
            SalesManID: $('#cmbSalesManName').val(),
            CustomerID: $('#txtCustomerID').val(),
            BranchID: $('#cmbBranchName').val(),
            AddnlDisc: $('#txtAddnlDisc').val(),
            TrdDisc: $('#txtTradeDisc').val(),
            FeedBack: $('#txtFeedBack').val(),
            lstProdDetails: objItemDetails,
            ActivityID: rdoActionID,
            "Flags": 1,
            "UserID": UID,

            "CusLatitude": $('#txtLatitude').val(),
            "CusLongtitude": $('#txtLongtitude').val(),
            "TransType": 1,// $('#txtTransType').val(),
            "TransID": 0,//$('#txtTransID').val()            
        };
        $.ajax({
            url: Aurl + "dailyactivity/save",
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(lstTrans),
            cache: false,
            processData: false,
            xhrFields: {
                withCredentials: true
            },
            success: function (data) {
                $("#btnSave").prop("disabled", false);
                $.each(data, function (i, items) {
                    if (items.MsgID == 0) {
                        //alert(items.Message);
                        showSuccessSnackbar(items.Message);
                        ClearForm();
                    }
                    else {
                        //$("#dvErrorName").html(items.Message);
                        //alert(items.Message);
                        showErrorSnackbar(items.Message);
                    }
                });
            }
        });
    }
    $("#btnSave").click(function () {
        if (cfFocus != 3) {
            if (SaveValidation()) {
                ConfirmDialogMsg("Do you want to save data?");
            }
        } else {
            if (SaveValidation()) {
                SaveData();
            }
        }
    });    
</script>
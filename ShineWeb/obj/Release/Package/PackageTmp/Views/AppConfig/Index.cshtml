@model ShineWeb.Models.SingleMasterModel
@{
    ViewBag.Title = ViewData["FormName"];
}
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<link href="~/Content/dataTables.dataTables.2.2.2.css" rel="stylesheet" />
<link href="~/Content/navbar.css" rel="stylesheet" />
<link href="~/Content/buttonTop.css" rel="stylesheet" />
@*<link rel="stylesheet" href="~/Content/jquery-ui.css">*@
<script src="~/Scripts/bootstrap.min.js"></script>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script src="~/Scripts/bootstrap-typeahead.min.js"></script>
<script src="~/Scripts/datatable.js"></script>
<script src="~/Scripts/dataTables.2.2.2.js"></script>   
<script src="~/Scripts/jquery-ui.min.js"></script>
<script src="~/Scripts/Validation.js"></script>
<script src="~/Scripts/js/refreshtoken.js"></script>
<style>
    :root {
        --primary-color: #4a90e2; /* Modern Blue */
        --secondary-color: #6c757d;
        --bg-color: #f8f9fa;
        --card-bg: #ffffff;
        --text-color: #333333;
        --border-color: #e0e0e0;
        --input-bg: #ffffff;
        --input-border: #ced4da;
        --table-header-bg: #f1f3f5;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    h4#MainHeading {
        color: var(--primary-color);
        font-weight: 600;
        margin-bottom: 20px;
        border-bottom: 2px solid var(--primary-color);
        padding-bottom: 10px;
        display: inline-block;
    }

    /* Modern Card Style */
    .modern-card {
        background: var(--card-bg);
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05); /* Soft shadow */
        padding: 20px;
        margin-bottom: 20px;
        border: 1px solid var(--border-color);
    }

    /* Tabs Styling */
    .tab {
        overflow: hidden;
        border-bottom: 1px solid var(--border-color);
        background-color: transparent;
        margin-bottom: 20px;
        display: flex;
        flex-wrap: wrap;
    }

    .tab button {
        background-color: transparent;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 10px 20px;
        transition: 0.3s;
        font-size: 15px;
        font-weight: 500;
        color: var(--secondary-color);
        border-bottom: 3px solid transparent;
        margin-right: 5px;
    }

    .tab button:hover {
        color: var(--primary-color);
        background-color: rgba(74, 144, 226, 0.05);
    }

    .tab button.active {
        color: var(--primary-color);
        border-bottom: 3px solid var(--primary-color);
        font-weight: 600;
    }

    .tabcontent {
        display: none;
        padding: 10px 0;
        animation: fadeIn 0.3s;
    }

    @@keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    /* Forms */
    .form-group {
        margin-bottom: 15px;
    }
    
    .control-label {
        font-weight: 500;
        margin-bottom: 5px;
        display: block;
        font-size: 13px;
    }

    .form-control {
        border-radius: 4px;
        border: 1px solid var(--input-border);
        box-shadow: none;
        transition: border-color 0.2s;
        height: 34px; /* Bootstrap 3 standard, but cleaner */
        padding: 6px 12px;
    }

    .form-control:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.1);
    }

    .gdInput {
        width: 100%;
        padding: 5px;
        border: 1px solid var(--input-border);
        border-radius: 4px;
    }

    /* Tables */
    .table {
        width: 100%;
        margin-bottom: 1rem;
        background-color: transparent;
    }

    .table thead th {
        vertical-align: bottom;
        border-bottom: 2px solid var(--border-color);
        background-color: var(--table-header-bg);
        font-weight: 600;
        color: #495057;
    }

    .table td {
        vertical-align: middle !important;
        font-size: 13px; /* Slightly larger than 11px for readability */
    }

    /* Toggle Switch - Enhanced */
    .switch {
        position: relative;
        display: inline-block;
        width: 40px;
        height: 20px;
        vertical-align: middle;
    }

    .switch input { 
        opacity: 0;
        width: 0;
        height: 0;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 34px;
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 16px;
        width: 16px;
        left: 2px;
        bottom: 2px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }

    input:checked + .slider {
        background-color: var(--primary-color);
    }

    input:focus + .slider {
        box-shadow: 0 0 1px var(--primary-color);
    }

    input:checked + .slider:before {
        transform: translateX(20px);
    }

    /* Buttons */
    .btn {
        border-radius: 4px;
        font-weight: 500;
        padding: 8px 16px;
    }

    .btn-info {
        background-color: #17a2b8;
        border-color: #17a2b8;
    }
    
    .btn-success {
        background-color: #28a745;
        border-color: #28a745;
    }
    
    .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
    }

    /* Floating Action / Footer Buttons */
    .action-footer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.9);
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        backdrop-filter: blur(5px);
    }

    /* Spacing Helpers */
    .mt-10 { margin-top: 10px; }
    .mb-10 { margin-bottom: 10px; }
    .ml-10 { margin-left: 10px; }
    .p-20 { padding: 20px; }

</style>
<body>
    <div>
        @Html.HiddenFor(model => model.FormName, new { @autocomplete = "off", @class = "form-control FormclrField", @id = "txtFormName" })
        @Html.HiddenFor(model => model.ID, new { @autocomplete = "off", @class = "form-control FormclrField", @id = "txtID" })
        <h4 id="MainHeading">@ViewData["FormName"]</h4>
        <hr />
        <div class="toastBox"></div>
        <div class="tab">
            <button class="tablinks" onclick="openTabs(event, 'dvGeneralSettings')">General Settings</button>
            <button class="tablinks" onclick="openTabs(event, 'dvPurchase')">Purchase</button>
            <button class="tablinks" onclick="openTabs(event, 'dvSales')">Sales</button>
            <button class="tablinks" onclick="openTabs(event, 'dvOtherTrans')">Other Transactions</button>
            <button class="tablinks" onclick="openTabs(event, 'dvPasswords')">Password</button>
            <button id="btnSuperadmin" class="tablinks" onclick="openTabs(event, 'dvSuperadmin')">Super Admin</button>
        </div>
        <div id="dvGeneralSettings" class="tabcontent">
            <div class="row">
                <!-- General Config Column -->
                <div class="col-md-7">
                    <div class="modern-card">
                        <h5 class="text-primary" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">General Configuration</h5>
                        
                        <div class="form-horizontal">
                            <div class="form-group">
                                <label class="control-label col-sm-4">Items Per Page</label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="cmbItemsperPage">
                                        <option value="10">10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                        <option value="-1">All</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Print Options</label>
                                <div class="col-sm-8">
                                    <label class="radio-inline"><input type="radio" name="rdoAllowPrint" id="rdoPrintYes" checked> Yes</label>
                                    <label class="radio-inline"><input type="radio" name="rdoAllowPrint" id="rdoPrintNo"> No</label>
                                    <label class="radio-inline"><input type="radio" name="rdoAllowPrint" id="rdoPrintPromptYes"> Prompt (Yes)</label>
                                    <label class="radio-inline"><input type="radio" name="rdoAllowPrint" id="rdoPrintPromptNo"> Prompt (No)</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Round Off</label>
                                <div class="col-sm-8">
                                    <div class="row">
                                        <div class="col-xs-12 mb-10">
                                            <label class="radio-inline" title="(ex: 57.6 + 0.4 = 58)"><input type="radio" name="rdoRoundoff" id="rdoNearest" checked> Nearest</label>
                                            <label class="radio-inline" title="(ex: 57.6 - 0.6 = 57)"><input type="radio" name="rdoRoundoff" id="rdoLowest"> Lowest</label>
                                            <label class="radio-inline" title="(ex: 57.2 + 0.8 = 58)"><input type="radio" name="rdoRoundoff" id="rdoHighest"> Highest</label>
                                        </div>
                                        <div class="col-xs-12">
                                            <input type="number" class="form-control" placeholder="Round off value" id="txtRoundoffValue" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Case Type</label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="cmbCaseType">
                                        <option value="1">UPPER CASE</option>
                                        <option value="2">lower case</option>
                                        <option value="3">Title Case</option>
                                        <option value="4">No Case</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Save Confirm Popup</label>
                                <div class="col-sm-8">
                                    <label class="radio-inline"><input type="radio" name="rdoConfPop" id="rdoCPYes" checked> Yes</label>
                                    <label class="radio-inline"><input type="radio" name="rdoConfPop" id="rdoCPNo"> No</label>
                                    <label class="radio-inline"><input type="radio" name="rdoConfPop" id="rdoCPDiscard"> Discard</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Clear Confirm Popup</label>
                                <div class="col-sm-8">
                                    <label class="radio-inline"><input type="radio" name="rdoClearConfPop" id="rdoClearCPYes" checked> Yes</label>
                                    <label class="radio-inline"><input type="radio" name="rdoClearConfPop" id="rdoClearCPNo"> No</label>
                                    <label class="radio-inline"><input type="radio" name="rdoClearConfPop" id="rdoClearCPDiscard"> Discard</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Close Confirm Popup</label>
                                <div class="col-sm-8">
                                    <label class="radio-inline"><input type="radio" name="rdoCloseConfPop" id="rdoCloseCPYes" checked> Yes</label>
                                    <label class="radio-inline"><input type="radio" name="rdoCloseConfPop" id="rdoCloseCPNo"> No</label>
                                    <label class="radio-inline"><input type="radio" name="rdoCloseConfPop" id="rdoCloseCPDiscard"> Discard</label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Decimal Values</label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="cmbDecimalValues">
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Default Branch</label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="cmbBranch">
                                        <option value="0">-- Select --</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">CC Commission %</label>
                                <div class="col-sm-8">
                                    <input class="form-control" type="number" id="txtVisaPern" min="0" max="99" maxlength="2" />
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Writeoff Amount</label>
                                <div class="col-sm-8">
                                    <input class="form-control" type="number" id="txtWriteoff" min="0" max="99" maxlength="2" />
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4" for="chkBeatMandatoryinCustomer">Beat Mandatory in Customer</label>
                                <div class="col-sm-8">
                                    <label class="switch">
                                        <input type="checkbox" id="chkBeatMandatoryinCustomer">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-4">Draft Auto Save (Mins)</label>
                                <div class="col-sm-8">
                                    <input class="form-control" type="number" id="txtDraftAutoSaveTimeInterval" maxlength="3" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Email & UPI Column -->
                <div class="col-md-5">
                    <div class="modern-card">
                        <h5 class="text-primary" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">E-Mail Configuration</h5>
                        <div class="form-group">
                            <label class="control-label">SMTP Host</label>
                            <input class="form-control" type="text" id="txtSMTPHost" placeholder="Enter SMTP Host">
                            <div style="color: red;" id="divErrorOnSMTPHost" class="clrdivs"></div>
                        </div>
                        <div class="form-group">
                            <label class="control-label">E-Mail ID</label>
                            <input class="form-control" type="text" id="txtEMail" placeholder="Enter E-Mail ID">
                            <div style="color: red;" id="divErrorOnEMail" class="clrdivs"></div>
                        </div>
                        <div class="form-group">
                            <label class="control-label">Password</label>
                            <input class="form-control" type="password" id="txtPassword" placeholder="Enter Password">
                            <div style="color: red;" id="divErrorOnPassowrd" class="clrdivs"></div>
                        </div>
                    </div>

                    <div class="modern-card">
                        <h5 class="text-primary" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">UPI Details</h5>
                        <div class="form-group">
                            <label class="control-label">UPI ID</label>
                            <input class="form-control" type="text" id="txtUPIID" placeholder="(ex. abcdef@oksbi)">
                        </div>
                        <div class="form-group">
                            <label class="control-label">UPI Name</label>
                            <input class="form-control" type="text" id="txtUPIName" placeholder="(your company name)">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="dvPurchase" class="tabcontent">
            <div class="row">
                <div class="col-md-6">
                    <div class="modern-card">
                        <h5 class="text-primary" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">Purchase Configuration</h5>
                        <div class="form-horizontal">
                            <div class="form-group">
                                <label class="control-label col-sm-6" for="chkPurchaseOneview">One View</label>
                                <div class="col-sm-6">
                                    <label class="switch">
                                        <input type="checkbox" id="chkPurchaseOneview">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="dvSales" class="tabcontent">
            <div class="row">
                <div class="col-md-7">
                    <div class="modern-card">
                        <h5 class="text-primary" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">Sales Configuration</h5>
                        <div class="form-horizontal">
                            <div class="form-group">
                                <label class="control-label col-sm-5">Invoice Default Customer</label>
                                <div class="col-sm-7">
                                    <input class="form-control" type="text" id="txtDefCustomer" placeholder="Search Customer..." />
                                    <input hidden id="txtDefCustomerID" />
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="control-label col-sm-5">Common Ageing Credit Days</label>
                                <div class="col-sm-7">
                                    <input class="form-control" type="number" id="txtCommonAgeingCreditDays" min="0" max="99" maxlength="2" />
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkAllsalesmaninInvoice">All Salesman in Invoice</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkAllsalesmaninInvoice">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkApplyschemeinQuotation">Apply Scheme in Quotation</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkApplyschemeinQuotation">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkSelectinvoiceinSR">Select Invoice in SR</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkSelectinvoiceinSR">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkInvoiceStockOnlyProduct">Invoice Stock Only (Y/N)</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkInvoiceStockOnlyProduct">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkSalesOneview">One View</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkSalesOneview">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkInvoiceallowduplicateitem">Invoice allow duplicate item</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkInvoiceallowduplicateitem">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkRestrictBlocklistinInvoice">Restrict Blocklist Customers</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkRestrictBlocklistinInvoice">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="dvOtherTrans" class="tabcontent">
            <div class="row">
                <div class="col-md-6">
                    <div class="modern-card">
                        <h5 class="text-primary" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">Other Transactions</h5>
                        <div class="form-horizontal">
                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkShowallstatus">Show All Status</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkShowallstatus">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-sm-5" for="chkRetainDate">Retain Date</label>
                                <div class="col-sm-7">
                                    <label class="switch">
                                        <input type="checkbox" id="chkRetainDate">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="control-label col-sm-5">Filter Date Type</label>
                                <div class="col-sm-7">
                                    <select class="form-control" id="cmbFilterdatetype">
                                        <option value="0">-- Select --</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="dvPasswords" class="tabcontent">            
            <div class="row">
                <div class="col-md-8">
                    <div class="modern-card">
                        <h5 class="text-primary" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">Password Management</h5>
                        <table class="table table-bordered table-striped" id="tblPasswords" width="100%">
                            <thead>
                                <tr class="trclrforcolheader">
                                    <th style="text-align:center;font-size: 12px;width:0%;">ID</th>
                                    <th style="text-align:center;font-size: 12px;width:70%;">Particulars</th>
                                    <th style="text-align:center;font-size: 12px;width:15%;">Password</th>
                                    <th style="text-align:center;font-size: 12px;width:15%;">Show/Hide</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>                
            </div>
        </div>
        <div id="dvSuperadmin" class="tabcontent">
            <div class="row">
                <div class="col-md-12">
                    <div class="modern-card">
                        <h5 class="text-primary" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">Super Admin Settings</h5>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label" for="chkEnablereturnprice">Enable Return Price</label>
                                    <div>
                                        <label class="switch">
                                            <input type="checkbox" id="chkEnablereturnprice">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="control-label">Back Up Path</label>
                                    <input type="text" id="txtBackupPath" class="form-control">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label">&nbsp;</label> <!-- Spacer -->
                                    <button class="btn btn-info btn-block" id="btnopen">Open All Forms</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <div class="modern-card">
                        <h6 class="text-secondary text-uppercase" style="font-weight:600; margin-bottom:15px;">Payment Mode</h6>
                        <table class="table table-bordered table-striped" id="tblPaymentMode" width="100%">
                            <thead>
                                <tr class="trclrforcolheader">
                                    <th style="text-align:center;font-size: 12px;width:0%;">ID</th>
                                    <th style="text-align:center;font-size: 12px;width:70%;">Payment Mode</th>
                                    <th style="text-align:center;font-size: 12px;width:15%;">Active</th>
                                    <th style="text-align:center;font-size: 12px;width:15%;">Order</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <div class="col-md-4">
                     <div class="modern-card">
                        <h6 class="text-secondary text-uppercase" style="font-weight:600; margin-bottom:15px;">Price Type</h6>
                        <table class="table table-bordered table-striped" id="tblPriceType" width="100%">
                            <thead>
                                <tr class="trclrforcolheader">
                                    <th style="text-align:center;font-size: 12px;width:0%;">ID</th>
                                    <th style="text-align:center;font-size: 12px;width:70%;">PriceType</th>
                                    <th style="text-align:center;font-size: 12px;width:15%;">Active</th>
                                    <th style="text-align:center;font-size: 12px;width:15%;">Order</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
                <div class="col-md-4">
                     <div class="modern-card">
                        <h6 class="text-secondary text-uppercase" style="font-weight:600; margin-bottom:15px;">Contra Mode</h6>
                        <table class="table table-bordered table-striped" id="tblContraMode" width="100%">
                            <thead>
                                <tr class="trclrforcolheader">
                                    <th style="text-align:center;font-size: 12px;width:0%;">ID</th>
                                    <th style="text-align:center;font-size: 12px;width:80%;">Contra Type</th>
                                    <th style="text-align:center;font-size: 12px;width:20%;">Active</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="action-footer">
            
            <button type="button" class="btn btn-danger btnclrclear" id="btnClear"><span class="glyphicon glyphicon-refresh"> Reset</span></button>
            <button type="button" class="btn btn-success btnclrsave" id="btnSave"><span class="glyphicon glyphicon-saved"> Save</span></button>
        </div>
    </div>
    
</body>


<script type="text/javascript">

    var UID = '@Session["LoginUserID"]';
    var Aurl = '@Session["APIurl"]';
    var TablePaymentMode = $('#tblPaymentMode').DataTable({
        "bFilter": false,
        "bSearchable": false,
        "bInfo": false,
        "bPaginate": false,
        "ordering": false,
        scrollY: "250px",
        scrollX: true,
        scrollCollapse: true,
        "columnDefs": [{ "targets": [0], "visible": false, searchable: false }, { "targets": [1], "width": "50%" }, { "targets": [2],"class" : "text-center" }],
    });
    var TableContraMode = $('#tblContraMode').DataTable({
        "bFilter": false,
        "bSearchable": false,
        "bInfo": false,
        "bPaginate": false,
        "ordering": false,
        scrollY: "250px",
        scrollX: true,
        scrollCollapse: true,
        "columnDefs": [{ "targets": [0], "visible": false, searchable: false }, { "targets": [2], "class": "text-center" }],
    });
    var TablePasswords = $('#tblPasswords').DataTable({
        "bFilter": false,
        "bSearchable": false,
        "bInfo": false,
        "bPaginate": false,
        "ordering": false,
        scrollY: "250px",
        scrollX: true,
        scrollCollapse: true,
        "columnDefs": [{ "targets": [0], "visible": false, searchable: false }, { "targets": [3], "class": "text-center" }],
    });
    var TablePriceType = $('#tblPriceType').DataTable({
        "bFilter": false,
        "bSearchable": false,
        "bInfo": false,
        "bPaginate": false,
        "ordering": false,
        scrollY: "250px",
        scrollX: true,
        scrollCollapse: true,
        "columnDefs": [{ "targets": [0], "visible": false, searchable: false }, { "targets": [1], "width": "50%" }, { "targets": [2], "class": "text-center" }],
    });

    function openTabs(evt, TabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(TabName).style.display = "block";
        evt.currentTarget.className += " active";
    }
    if (UID != 1) {
        $("#btnSuperadmin").hide()
    }
    document.getElementById('dvGeneralSettings').style.display = "block";
    $('#btnClear').click(function (e) {
        openallformsinmypage();
        if (cfFocus != 3) { ClearConfirmDialogMsg("Do you want to clear?"); } else { ClearForm(); }
    });
    $('#btnSave').click(function (e) {
        //ConfirmDialogMsg("Do you want to save?");
        $(".clrdiv").html("");
        //if (cfFocus != 3) { ConfirmDialogMsg("Do you want to save data?"); } else { SaveData(); }
        if (ValidateOrder()) {
            if (cfFocus != 3) {
                ConfirmDialogMsg("Do you want to save data?");
            } else {
                SaveData(2);
            }
        }
    });
    var arrCustomer = [];
    var DefCName = "", DefCID = "";
    GetData(3);
    function GetData(nMode) {
        $.ajax({
            url: Aurl + "applicationconfig/get",
            type: 'get',
            contentType: 'json',
            data: { Mode: nMode, Name: "" },
            xhrFields: {
                withCredentials: true
            },
            success: function (data) {
                if (nMode == 1) {
                    arrCustomer = [];
                    $('#cmbFilterdatetype').find("option").remove();
                    $.each(data, function (i, items) {
                        $("#cmbCaseType").val(items.CaseType);
                        $("#rdoCPYes").prop("checked", items.Confirmpopup == 1);
                        $("#rdoCPNo").prop("checked", items.Confirmpopup == 2);
                        $("#rdoCPDiscard").prop("checked", items.Confirmpopup == 3);

                        $("#rdoClearCPYes").prop("checked", items.ClearConfirmpopup == 1);
                        $("#rdoClearCPNo").prop("checked", items.ClearConfirmpopup == 2);
                        $("#rdoClearCPDiscard").prop("checked", items.ClearConfirmpopup == 3);

                        $("#rdoCloseCPYes").prop("checked", items.CloseConfirmpopup == 1);
                        $("#rdoCloseCPNo").prop("checked", items.CloseConfirmpopup == 2);
                        $("#rdoCloseCPDiscard").prop("checked", items.CloseConfirmpopup == 3);

                        $("#rdoNearest").prop("checked", items.Roundoff == 1);
                        $("#rdoLowest").prop("checked", items.Roundoff == 2);
                        $("#rdoHighest").prop("checked", items.Roundoff == 3);
                        $("#txtRoundoffValue").val(items.RoundoffValue);
                        $("#txtSMTPHost").val(items.SMTPHost);
                        $("#txtEMail").val(items.EMail);
                        $("#txtPassword").val(items.Password);
                        $("#txtBackupPath").val(items.BackupPath);

                        $("#cmbDecimalValues").val(items.DecimalValues);
                        $("#chkShowallstatus").prop("checked", items.Showallstatus == 1);
                        $("#chkRetainDate").prop("checked", items.RetainDate == 1);

                        $("#cmbBranch").val(items.DefaultBranch);
                        $("#chkEnablereturnprice").prop("checked", items.EnableReturnPrice == 1);
                        $("#chkAllsalesmaninInvoice").prop("checked", items.AllSalesmanInvoice == 1);
                        $("#chkApplyschemeinQuotation").prop("checked", items.ApplySchemeinQuotation == 1);
                        $("#chkSelectinvoiceinSR").prop("checked", items.SelectinvoiceinSR == 1);
                        $("#chkInvoiceStockOnlyProduct").prop("checked", items.InvoiceStockOnlyProduct == 1);
                        $("#chkInvoiceallowduplicateitem").prop("checked", items.Invoiceallowduplicateitem == 1);
                        $("#chkRestrictBlocklistinInvoice").prop("checked", items.RestrictBlocklistinInvoice == 1);
                        $("#chkBeatMandatoryinCustomer").prop("checked", items.BeatMandatoryinCustomer == 1);
                        
                        $("#txtCommonAgeingCreditDays").val(items.CommonAgeingCreditDays);
                        $("#txtDraftAutoSaveTimeInterval").val(items.DraftAutoSaveTimeInterval);
                        
                        $("#chkPurchaseOneview").prop("checked", items.PurchaseOneView == 1);
                        $("#chkSalesOneview").prop("checked", items.SalesOneView == 1);
                        $("#cmbItemsperPage").val(items.ItemsperPage);
                        //SelectinvoiceinSR
                        $("#txtVisaPern").val(items.VisaPern);
                        $("#txtUPIID").val(items.UPIID);
                        $("#txtUPIName").val(items.UPIName);
                        $("#txtWriteoff").val(items.WriteoffAmt);
                        //rdoPrintYes,rdoPrintNo,rdoPrintPromptYes,rdoPrintPromptNo
                        $("#rdoPrintYes").prop("checked", items.AllowPrint == 1);
                        $("#rdoPrintNo").prop("checked", items.AllowPrint == 2);
                        $("#rdoPrintPromptYes").prop("checked", items.AllowPrint == 3);
                        $("#rdoPrintPromptNo").prop("checked", items.AllowPrint == 4);
                        //TablePaymentMode.draw().clear(); TablePaymentMode.draw().clear();
                        //TableContraMode.draw().clear(); TableContraMode.draw().clear();
                        //TablePasswords.draw().clear(); TablePasswords.draw().clear();
                        //TablePriceType.draw().clear(); TablePriceType.draw().clear();
                        var nCount = items.lstPaymode.length;
                        var mxl = nCount.toString().length;
                        //$.each(items.lstConfigPasswords, function (i, pwditems) {
                        //    TablePasswords.row.add([
                        //        pwditems.ID,
                        //        pwditems.Name,
                        //        '<input type="password" id="txtpwd' + i + '" class="gdInput"  name="Password" value="' + pwditems.Passwords +'"/>',
                        //        '<label for="chkActivea' + i + '">Show/Hide</label>'
                        //    ]).draw(false);
                        //});
                        $('#tblPasswords').DataTable({
                            scrollY: "450px",
                            scrollX: true,
                            scrollCollapse: true,
                            paging: false,
                            destroy: true,
                            data: items.lstConfigPasswords,
                            fixedColumns: false,
                            searching: false,
                            ordering: false,
                            sorting: false,
                            columns: [
                                { "data": "ID", "autoWidth": true, "visible": false, className: "dt-body-left" },
                                { "data": "Name", "autoWidth": true, className: "dt-body-left" },
                                {
                                    className: "dt-body-center",
                                    "mRender": function (data, type, value, meta) {
                                        var rowIndex = meta.row;
                                        var _action = '<input type="password" id="txtpwd' + rowIndex + '" class="gdInput"  name="Password" value="' + value.Passwords + '"/>';
                                        return _action;
                                    }
                                },
                                {
                                    className: "dt-body-center",
                                    "mRender": function (data, type, value, meta) {
                                        var rowIndex = meta.row;
                                        var _action = '<span id="icon' + rowIndex + '" class="glyphicon glyphicon-eye-open" style="cursor:pointer; font-size:1.2em;" title="Show Password"></span>';
                                        return _action;
                                    }
                                },
                            ],
                        });
                        TablePasswords = $('#tblPasswords').DataTable();
                        $.each(items.lstPaymode, function (i, pmitems) {
                            if (pmitems.TypeID == "1") {
                                var chk = pmitems.Active == "True" ? "checked" : "";
                                TablePaymentMode.row.add([
                                    pmitems.ID,
                                    '<label for="chkActive' + i + '">' + pmitems.Name + '</label>',
                                    '<input type="checkbox" id="chkActive' + i + '"  name="Active" ' + chk + ' />',
                                    '<input type="number" min="0" maxlength="' + mxl + '" id="txtOrder' + i + '" class="form-control" name="OrderBy" value="' + pmitems.Order + '" onkeypress="return isNumberKey(event)" oninput="javascript: if (this.value.length > this.maxLength) { this.value = this.value.slice(0, this.maxLength); }"/>'
                                ]).draw(false);
                            }
                            else if (pmitems.TypeID == "2") {
                                var cst = {
                                    "label": pmitems.Name,
                                    "code": pmitems.Code,
                                    "id": pmitems.ID,
                                }
                                arrCustomer.push(cst);
                                if (items.DefaultCustID == pmitems.ID) {
                                    DefCName = pmitems.Name;
                                    DefCID = pmitems.ID;
                                }
                            }
                            else if (pmitems.TypeID == "3") {
                                var chk = pmitems.Active == "True" ? "checked" : "";
                                TableContraMode.row.add([
                                    pmitems.ID,
                                    '<label for="chkCMActive' + i + '">' + pmitems.Name + '</label>',
                                    '<input type="checkbox" id="chkCMActive' + i + '"  name="CMActive" ' + chk + ' />'
                                ]).draw(false);
                            }
                            else if (pmitems.TypeID == "4") {
                                var chk = pmitems.Active == "True" ? "checked" : "";
                                TablePriceType.row.add([
                                    pmitems.ID,
                                    '<label for="chkPTActive' + i + '">' + pmitems.Name + '</label>',
                                    '<input type="checkbox" id="chkPTActive' + i + '"  name="PTActive" ' + chk + ' />',
                                    '<input type="number" min="0" maxlength="' + mxl + '" id="txtPTOrder' + i + '" class="form-control" name="PTOrderBy" value="' + pmitems.Order + '" onkeypress="return isNumberKey(event)" oninput="javascript: if (this.value.length > this.maxLength) { this.value = this.value.slice(0, this.maxLength); }"/>'
                                ]).draw(false);
                            } //
                            else if (pmitems.TypeID == "5") {
                                $('#cmbFilterdatetype').append($('<option/>', {
                                    value: pmitems.ID,
                                    text: pmitems.Name,
                                }));
                                $('#cmbFilterdatetype').val(items.FilterDate);
                            }
                        });

                    });
                    SetAutlistforFields();
                }
                else if (nMode == 3) {
                    $('#cmbBranch').find("option").remove();
                    $('#cmbBranch').append($('<option/>', {
                        value: 0,
                        text: "-- Select --",
                        class: ""
                    }));
                    $.each(data, function (i, items) {
                        $('#cmbBranch').append($('<option/>', {
                            value: items.ID,
                            text: items.Name,
                        }));
                    });
                    GetData(1);
                }
            }
            , error: function (data) {
                if (data.status == "401") {
                    var msg = data.responseJSON.Message;
                    ////showErrorSnackbar(msg + " Logout and Login again.");
                }
            }
        });
    }
    function SetAutlistforFields() {
        $("#txtDefCustomer").autocomplete({
            minLength: 0, autoFocus: true,
            source: arrCustomer,
            //focus: function (event, ui) {
            //    $("#txtSearch").val(ui.item.name);
            //    return false;
            //},
            select: function (event, ui) {
                $("#txtDefCustomer").val(ui.item.label);
                $("#txtDefCustomerID").val(ui.item.id);
                return false;
            },
        }).autocomplete("instance")._renderItem = function (ul, item) {
            return $("<li class='each'>")
                .append("<div class='acItem'><span class='name'>" +
                    item.label + "</span></div>")
                .appendTo(ul);
            };
        $("#txtDefCustomer").val(DefCName);
        $("#txtDefCustomerID").val(DefCID);

    }
    $('input[type=number]').focusin(function (e) {
        $(this).select();
    });
    function isNumberKey(evt) {
        var charCode = (evt.which) ? evt.which : evt.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57))
            return false;
        return true;
    }
    $('#tblPasswords tbody').on('click', 'td', function () {
        if (TablePasswords.cell(this).index().columnVisible == 2) {
            var rowdata = TablePasswords.row($(this).parents('tr')).data();
            var PwdID = rowdata.ID;//[0];
            //showErrorSnackbar(rowdata[2]);
            $("#tblPasswords tbody tr").each(function () {
                var currrowdata = TablePasswords.row($(this)).data();
                var GridPwdID = currrowdata.ID;//[0];

                if (PwdID == GridPwdID) {//ProdID == GridProdID
                    $(this).find("input").each(function (index) {
                        const fieldtype = $(this).attr("type");
                        if (fieldtype == "password") {
                            //$(this).type = "text";
                            $(this).attr('type', 'text');
                        }
                        else {
                            //$(this).type = "password";
                            $(this).attr('type', 'password');
                        }
                    });
                    // Toggle Icon
                    var $icon = $(this).find('.glyphicon');
                    if ($icon.hasClass('glyphicon-eye-open')) {
                        $icon.removeClass('glyphicon-eye-open').addClass('glyphicon-eye-close');
                        $icon.attr('title', 'Hide Password');
                    } else {
                        $icon.removeClass('glyphicon-eye-close').addClass('glyphicon-eye-open');
                        $icon.attr('title', 'Show Password');
                    }
                }
            });
        }
    });

    function ValidateOrder() {
        var IsValid = true;
        var saperm = $("#btnSuperadmin").is(":visible");
        if (saperm) {
            $("#tblPaymentMode tbody tr").each(function () {
                var valhasvalue = true;
                $(this).css("color", "black");
                $(this).find("input").each(function (index) {
                    $(this).css("border-color", "black");
                    if ($(this).val() == "") {
                        IsValid = false;
                        valhasvalue = false;
                        $(this).css("border-color", "red");
                    }
                });
                if (!valhasvalue) {
                    $(this).css("color", "red");
                    showErrorSnackbar("Payment Mode Order Value should not be empty");
                }
            });
            $("#tblPriceType tbody tr").each(function () {
                var valhasvalue = true;
                $(this).css("color", "black");
                $(this).find("input").each(function (index) {
                    $(this).css("border-color", "black");
                    if ($(this).val() == "") {
                        IsValid = false;
                        valhasvalue = false;
                        $(this).css("border-color", "red");
                    }
                });
                if (!valhasvalue) {
                    $(this).css("color", "red");
                    showErrorSnackbar("Price Type Order Value should not be empty");
                }
            });
        }
        var pwdhasvalue = true;
        $("#tblPasswords tbody tr").each(function () {
            $(this).find("input").each(function (index) {
                $(this).css("border-color", "black");
                if ($(this).val() == "") {
                    IsValid = false;
                    pwdhasvalue = false;
                    $(this).css("border-color", "red");
                }
            });
        });
        if (!pwdhasvalue) {
            IsValid = false;
            showErrorSnackbar("Password should not be empty");
        }
        if (IsValid) {
            if ($("#txtDefCustomer").val() != "") {
                const exists = arrCustomer.filter(acc => acc.label == $("#txtDefCustomer").val().trim());
                if (exists.length == 0) {
                    IsValid = false;
                    showErrorSnackbar("<b>Sales : </b> Select customer from list");
                }
            } else {
                $("#txtDefCustomerID").val(0);
            }
        }
        return IsValid;
    }
   
    function SaveData() {
        $("#btnSave").prop("disabled", true);
        var listmenu = [], listpwd = [];
        $("#tblPaymentMode tbody tr").each(function () {
            var nOrder = 0;
            rowdata = TablePaymentMode.row($(this)).data();
            var PMID = rowdata[0];
            var valhasvalue = true;
            var nActive = 0, nOrder = 0;
            $(this).find("input").each(function (index) {
                const fieldName = $(this).attr("name");
                const fieldID = $(this).attr("id");
                if (fieldName == "Active") {
                    nActive = $(this).is(":checked") ? 1 : 0;
                }
                if (fieldName == "OrderBy") {
                    nOrder = $(this).val();
                }
            });
            var lst = {
                "TypeID": 1,
                "ID": PMID,
                "Active": nActive,
                "Order": nOrder
            }
            listmenu.push(lst);
        });
        $("#tblContraMode tbody tr").each(function () {
            rowdata = TableContraMode.row($(this)).data();
            var ContID = rowdata[0];
            var nActive = 0;
            $(this).find("input").each(function (index) {
                const fieldName = $(this).attr("name");
                const fieldID = $(this).attr("id");
                if (fieldName == "CMActive") {
                    nActive = $(this).is(":checked") ? 1 : 0;
                }
            });
            var lst = {
                "TypeID": 2,
                "ID": ContID,
                "Active": nActive,
            }
            listmenu.push(lst);
        });
        $("#tblPasswords tbody tr").each(function () {
            rowdata = TablePasswords.row($(this)).data();
            var pwdID = rowdata.ID;//[0], pass = "";
            $(this).find("input").each(function (index) {
                const fieldName = $(this).attr("name");
                const fieldID = $(this).attr("id");
                if (fieldName == "Password") {
                    pass = $(this).val();
                }
            });
            var lst = {
                "ID": pwdID,
                "Passwords": pass,
            }
            listpwd.push(lst);
        });
        $("#tblPriceType tbody tr").each(function () {
            var nOrder = 0;
            rowdata = TablePriceType.row($(this)).data();
            var PMID = rowdata[0];
            var valhasvalue = true;
            var nActive = 0, nOrder = 0;
            $(this).find("input").each(function (index) {
                const fieldName = $(this).attr("name");
                const fieldID = $(this).attr("id");
                if (fieldName == "PTActive") {
                    nActive = $(this).is(":checked") ? 1 : 0;
                }
                if (fieldName == "PTOrderBy") {
                    nOrder = $(this).val();
                }
            });
            var lst = {
                "TypeID": 4,
                "ID": PMID,
                "Active": nActive,
                "Order": nOrder
            }
            listmenu.push(lst);
        });
        var lstMaster = {
            "Mode": 2,
            "CaseType": $("#cmbCaseType").val(),
            "Confirmpopup": $("#rdoCPYes").is(":checked") ? 1 : $("#rdoCPNo").is(":checked") ? 2 : 3,
            "ClearConfirmpopup": $("#rdoClearCPYes").is(":checked") ? 1 : $("#rdoClearCPNo").is(":checked") ? 2 : 3,
            "CloseConfirmpopup": $("#rdoCloseCPYes").is(":checked") ? 1 : $("#rdoCloseCPNo").is(":checked") ? 2 : 3,
            "Roundoff": $("#rdoNearest").is(":checked") ? 1 : $("#rdoLowest").is(":checked") ? 2 : 3,
            "RoundoffValue": $("#txtRoundoffValue").val(),
            "SMTPHost": $("#txtSMTPHost").val(),
            "EMail": $("#txtEMail").val(),
            "Password": $("#txtPassword").val(),
            "BackupPath": $("#txtBackupPath").val(),
            "DecimalValues": $("#cmbDecimalValues").val(),
            "Showallstatus": $("#chkShowallstatus").is(":checked") ? 1 : 0,
            "RetainDate": $("#chkRetainDate").is(":checked") ? 1 : 0,
            "DefaultBranch": $("#cmbBranch").val(),
            "EnableReturnPrice": $("#chkEnablereturnprice").is(":checked") ? 1 : 0,
            "VisaPern": $("#txtVisaPern").val(),
            "DefaultCustID": $("#txtDefCustomerID").val(),
            "AllSalesmanInvoice": $("#chkAllsalesmaninInvoice").is(":checked") ? 1 : 0,
            "UPIID": $("#txtUPIID").val(),
            "UPIName": $("#txtUPIName").val(),
            "WriteoffAmt": $("#txtWriteoff").val(),
            "AllowPrint": $("#rdoPrintYes").is(":checked") ? 1 : $("#rdoPrintNo").is(":checked") ? 2 : $("#rdoPrintPromptYes").is(":checked") ? 3 : 4,
            "ApplySchemeinQuotation": $("#chkApplyschemeinQuotation").is(":checked") ? 1 : 0,
            "SelectinvoiceinSR": $("#chkSelectinvoiceinSR").is(":checked") ? 1 : 0,
            "InvoiceStockOnlyProduct": $("#chkInvoiceStockOnlyProduct").is(":checked") ? 1 : 0,
            "Invoiceallowduplicateitem": $("#chkInvoiceallowduplicateitem").is(":checked") ? 1 : 0,
            "RestrictBlocklistinInvoice": $("#chkRestrictBlocklistinInvoice").is(":checked") ? 1 : 0,
            "BeatMandatoryinCustomer": $("#chkBeatMandatoryinCustomer").is(":checked") ? 1 : 0,            
            "PurchaseOneView": $("#chkPurchaseOneview").is(":checked") ? 1 : 0,
            "SalesOneView": $("#chkSalesOneview").is(":checked") ? 1 : 0,
            "FilterDate": $('#cmbFilterdatetype').val(),
            "ItemsperPage": $("#cmbItemsperPage").val(),
            "CommonAgeingCreditDays": $("#txtCommonAgeingCreditDays").val(),
            "DraftAutoSaveTimeInterval": $("#txtDraftAutoSaveTimeInterval").val(),            
            "UserID": UID,
            "lstPaymode": listmenu,
            "lstConfigPasswords": listpwd
        };
        $.ajax({
            url: Aurl + "applicationconfig/save",
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            data: JSON.stringify(lstMaster),
            cache: false,
            processData: false,
            xhrFields: {
                withCredentials: true
            },
            success: function (data) {
                $("#btnSave").prop("disabled", false);
                $.each(data, function (i, items) {
                    if (items.MsgID == 0) {
                        showSuccessSnackbar(items.Message);
                        //ClearForm();
                        //GetData()
                    }
                    else {
                        $("#dvErrorName").html(items.Message);
                        showErrorSnackbar(items.Message);
                    }
                });
            }, error: function (data) {
                $("#btnSave").prop("disabled", false);
                if (data.status == "401") {
                    var msg = data.responseJSON.Message;
                    ////showErrorSnackbar(msg + " Logout and Login again.");
                }
            }
        });

    }
    function ClearForm() {
        GetData(1);
        $(".clrdiv").html("");
    }

    function openallformsinmypage() {
        const divs = document.querySelectorAll('#listContainer div');
        const links = [];

        // Collect all link hrefs
        divs.forEach(div => {
            div.querySelectorAll('a').forEach(link => {
                links.push(link.href);
            });
        });

        let index = 0;

        const intervalId = setInterval(() => {
            if (index >= links.length) {
                clearInterval(intervalId);
                return;
            }

            window.open(links[index], '_blank');
            index++;
        }, 1500); // 1000 ms = 1 second

    }
    $('#btnopen').click(function (e) {
        openallformsinmypage();
    });
</script>